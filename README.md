# Antrel test task

Проект представляет собой выполненное тестовое задание.

# Постановка задачи.
1.   Нахождение позы человека. Для этого используйте предоставленную готовую модель - YOLOv12-S pose-estimination. Вам важно найти местоположение пяток человека в пространстве для контроля пребывания их в чистой или грязной зоне (как правило это последние по индексу keypoints в result-е инференса модели).  

2.   Нахождение и детекция обуви. Необходимо распознать на картинке два класса, грязную (`dirt boot`) и чистую обувь (`green boot`). Для облегчения выполнения задачи модель детекции обуви уже дана (на базе YOLOv12-S).  

3.   Напишите решение, которое способно определить, находится ли `dirt boot` или `green boot` в области `ROI`, центром которой является пятка скелета. Размеры 'ROI' определите как полигон (набор связанных точек). Необходимо, чтобы ваше решение отрабатывало следующие ситуации:  
*   если пятка находится в грязной зоне, обувь находится в грязной зоне (с некоторым IoU), и обувь находится рядом к пятке - выдать **ALARM**  
*   если пятка находится в чистой зоне, обувь находится в чистой зоне (с некоторым IoU), и обувь находится рядом к пятке - выдать **GOOD**  
*   грязная обувь в чистой зоне без человека не считается за нарушение. Чистая обувь в грязной и с человеком, и без человека - не нарушение.  
*   на датасете в правой части картинок навалена размеченная обувь. В некоторых сценариях обучения это может влиять на качество модели, так как мы получаем множественно статичные метки классов. Будет плюсом, если Вы предложете как это учесть на уровне валидации данных - возможно, стоит вообще исключить эту зону при подготовке батчей для даталоудеров при обучении, либо же придумать некие "сдвиги" или прочие сценарии рандомизации однотипных расположений. Можете просто описать свои мысли текстом :)

# Решение.
Код с решением задачи находится в одном файле - main.py. Он написан следующим образом: сначала идут использующиеся в
программе константы, потом идут вспомогательные функции, затем идут функции, которые решают непосредственно поставленные
задачи. В конце находится функция main, в которой отдельные функции последовательно вызываются.  

Запуск решения:  
1. Скачать себе проект с github архивом через web-интерфейс, либо командой

`git clone https://github.com/AlekseiRodionov/antrel-cv-testtask.git`

2. В директории проекта запустить:

`docker build -t <название_образа> .`

3. Запустить контейнер:

`docker run <название_образа>`

Либо без докера настроить и запустить проект локально.

ВАЖНО: т.к. в докере есть трудности с запуском приложений с GUI и его элементами, то в коде есть закомментированная
строка с вызовом функции show_image. Если запускать проект вне докера, то можно раскомментировать эту строку.

Ответ на четвёртый пункт третьего задания находится в файле 3.4_answer.txt.


